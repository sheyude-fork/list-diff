{
  "version": 3,
  "sources": [
    "node_modules/browser-pack-flat/_prelude",
    "src/types.ts",
    "src/utils.ts",
    "src/listDiff.ts",
    "src/applyPatches.ts",
    "node_modules/browser-pack-flat/_postlude",
    "src/index.ts"
  ],
  "names": [
    "f",
    "exports",
    "module",
    "define",
    "amd",
    "window",
    "global",
    "self",
    "this",
    "ListDiff",
    "PatchType",
    "_$types_4",
    "ADD",
    "DELETE",
    "REPOSITION",
    "_$utils_5",
    "difference",
    "a",
    "b",
    "reduce",
    "r",
    "value",
    "index",
    "concat",
    "indexOf",
    "intersection",
    "bIndex",
    "_$listDiff_3",
    "listDiff",
    "patches",
    "deleted",
    "added",
    "inter",
    "reverse",
    "type",
    "id",
    "calAfterForRepostion",
    "after",
    "_$applyPatches_1",
    "applyPatches",
    "input",
    "tinker",
    "SimpleTinker",
    "output",
    "i",
    "length",
    "patch",
    "applyAdditon",
    "applyDeletion",
    "applyRepostion",
    "[object Object]",
    "filter",
    "push",
    "slice",
    "_$index_2"
  ],
  "mappings": "CAAA,SAAAA,GAAA,GAAA,iBAAAC,SAAA,oBAAAC,OAAAA,OAAAD,QAAAD,SAAA,GAAA,mBAAAG,QAAAA,OAAAC,IAAAD,OAAA,GAAAH,OAAA,EAAA,oBAAAK,OAAAA,OAAA,oBAAAC,OAAAA,OAAA,oBAAAC,KAAAA,KAAAC,MAAAC,SAAAT,KAAA,CAAA,WAAA,ICAYU,EDCZC,EAAA,qDCDYD,EAAAC,EAAAD,YAAAC,EAAAD,UAAS,KACjBE,IAAA,MACAF,EAAAG,OAAA,SACAH,EAAAI,WAAA,uECESC,EAAAC,WAAA,EAAkBC,EAAQC,IACnCD,EAAEE,OACE,CAACC,EAAWC,EAAUC,IAClBF,EAAEG,QACwB,IAAtBL,EAAEM,QAAQH,GACJ,CAAC,CACCA,MAAAA,EACAC,MAAAA,IACC,IAEjB,KAGKP,EAAAU,aAAA,EAAoBR,EAAQC,IACrCD,EAAEE,OACE,CAACC,EAAWC,EAAUC,KAClB,MAAMI,EAASR,EAAEM,QAAQH,GAEzB,OAAOD,EAAEG,OACLG,GAAU,GAAKA,GAAUJ,EACnB,CAAC,CACCD,MAAAA,EACAC,MAAOI,IACN,KAGjB,+DC5BKC,EAAAC,SAAA,EAAYX,EAAaC,KAClC,IAAIW,EAAmB,GACvB,MAAMC,EAAuBf,EAAAC,WAAWC,EAAGC,GACrCa,EAAqBhB,EAAAC,WAAWE,EAAGD,GACnCe,EAAqBjB,EAAAU,aAAaR,EAAGC,GAAGe,UAG9CJ,EAAUC,EAAQX,OAAO,CAACU,GAAWR,MAAAA,KAAYQ,EAAQN,OAAO,CAAC,CAC7DW,KAAMvB,EAAAD,UAAUG,OAChBsB,GAAId,KACHQ,GAGL,MAAMO,EAAwBd,IAC1B,KAAOA,EAAQ,IAAkC,IAA7BL,EAAEO,QAAQN,EAAEI,EAAQ,KACpCA,IAGJ,OAAOA,EAAQ,EAAIJ,EAAEI,EAAQ,GAAK,IAgBtC,OAbAO,EAAUG,EAAMb,OAAO,CAACU,GAAWR,MAAAA,EAAOC,MAAAA,KAAYO,EAAQN,OAAO,CAAC,CAClEW,KAAMvB,EAAAD,UAAUI,WAChBqB,GAAId,EACJgB,MAAOD,EAAqBd,MAC3BO,GAGKE,EAAMZ,OAAO,CAACU,GAAWR,MAAAA,EAAOC,MAAAA,KAAYO,EAAQN,OAAO,CAAC,CAClEW,KAAMvB,EAAAD,UAAUE,IAChBuB,GAAId,EACJgB,MAAOf,EAAQ,EAAIJ,EAAEI,EAAQ,GAAK,MACjCO,+DCjCIS,EAAAC,aAAA,EAAgBC,EAAiBX,EAAkBY,EAAiB,IAAIC,KACjF,IAAIC,EAAmBH,EAEvB,IAAK,IAAII,EAAI,EAAGA,EAAIf,EAAQgB,OAAQD,IAAK,CACrC,MAAME,EAAQjB,EAAQe,GAEtB,OAAQE,EAAMZ,MACd,KAAKvB,EAAAD,UAAUE,IACX+B,EAASF,EAAOM,aAAaJ,EAAQG,GACrC,MACJ,KAAKnC,EAAAD,UAAUG,OACX8B,EAASF,EAAOO,cAAcL,EAAQG,GACtC,MACJ,KAAKnC,EAAAD,UAAUI,WACX6B,EAASF,EAAOQ,eAAeN,EAAQG,IAI/C,OAAOH,IAGX,MAAaD,EACTQ,cAAeV,EAAiBM,GAC5B,GAAIA,EAAMZ,OAASvB,EAAAD,UAAUG,OAAQ,OAAO2B,EAE5C,MAAML,GAAEA,GAAOW,EACf,OAAON,EAAMW,OAAOP,GAAKA,IAAMT,GAGnCe,eAAgBV,EAAiBM,GAC7B,GAAIA,EAAMZ,OAASvB,EAAAD,UAAUI,WAAY,OAAO0B,EAEhD,MAAML,GAAEA,EAAEE,MAAEA,GAAUS,EAEtB,GAAc,KAAVT,EACA,OAAIG,EAAM,KAAOL,EAAWK,GAC5BA,EAAQA,EAAMW,OAAOP,GAAKA,IAAMT,GACzB,CAACA,KAAOK,IACZ,CACH,MAAMlB,EAAQkB,EAAMhB,QAAQW,GAC5B,OAAIK,EAAMlB,EAAQ,KAAOe,EAAcG,EAEhCA,EAAMrB,OAAO,CAACwB,EAAQC,KACrBA,IAAMT,IACNQ,EAAOS,KAAKR,GACRA,IAAMP,GAAOM,EAAOS,KAAKjB,IAG1BQ,GACR,KAIXO,aAAcV,EAAiBM,GAC3B,GAAIA,EAAMZ,OAASvB,EAAAD,UAAUE,IAAK,OAAO4B,EAEzC,MAAML,GAAEA,EAAEE,MAAEA,GAAUS,EACtB,GAAc,KAAVT,EAAc,MAAO,CAACF,KAAOK,GACjC,MAAMlB,EAAQkB,EAAMhB,QAAQa,GAC5B,MAAO,IAAIG,EAAMa,MAAM,EAAG/B,EAAQ,GAAIa,KAAOK,EAAMa,MAAM/B,EAAQ,KAtCzEgB,EAAAI,aAAAA,WCtBA,wDCDgBY,EAAA5C,UAAAC,EAAAD,UACP4C,EAAA1B,SAAAD,EAAAC,SACA0B,EAAAf,aAAAD,EAAAC,aAAce,EAAAZ,aAAAJ,EAAAI,aDDvBY",
  "sourcesContent": [
    "(function(f){if(typeof exports===\"object\"&&typeof module!==\"undefined\"){module.exports=f()}else if(typeof define===\"function\"&&define.amd){define([],f)}else{var g;if(typeof window!==\"undefined\"){g=window}else if(typeof global!==\"undefined\"){g=global}else if(typeof self!==\"undefined\"){g=self}else{g=this}g.ListDiff = f()}})(function(){var define,module,exports;\n",
    "export enum PatchType {\n    ADD = 'ADD',\n    DELETE = 'DELETE',\n    REPOSITION = 'REPOSITION'\n}\n\nexport type Patch = {\n    type: PatchType,\n    id: string,\n    after?: string\n}\n\nexport interface Tinker {\n    applyDeletion (input: string[], deletionPatch: Patch): string[];\n    applyRepostion (input: string[], repositionpPatch: Patch): string[];\n    applyAdditon (input: string[], addtionPatch: Patch): string[];\n}\n",
    "export type E<T> = {\n    value: T,\n    index: number\n}\n\nexport const difference = <T> (a: T[], b: T[]): E<T>[] =>\n    a.reduce(\n        (r: E<T>[], value: T, index: number) =>\n            r.concat(\n                b.indexOf(value) === -1\n                    ? [{\n                        value,\n                        index\n                    }] : []\n            ),\n        []\n    )\n\nexport const intersection = <T> (a: T[], b: T[]): E<T>[] =>\n    a.reduce(\n        (r: E<T>[], value: T, index: number) => {\n            const bIndex = b.indexOf(value)\n\n            return r.concat(\n                bIndex > -1 && bIndex != index\n                    ? [{\n                        value,\n                        index: bIndex\n                    }] : []\n            )\n        },\n        []\n    )\n",
    "import { Patch, PatchType } from './types'\nimport { E, difference, intersection } from './utils'\n\nexport const listDiff = (a: string[], b: string[]): Patch[] => {\n    let patches: Patch[] = []\n    const deleted: E<string>[] = difference(a, b)\n    const added: E<string>[] = difference(b, a)\n    const inter: E<string>[] = intersection(a, b).reverse()\n\n    // 被删除的元素\n    patches = deleted.reduce((patches, { value }) => patches.concat([{\n        type: PatchType.DELETE,\n        id: value\n    }]), patches)\n\n    // 移动的元素\n    const calAfterForRepostion = (index: number) => {\n        while (index > 0 && a.indexOf(b[index - 1]) === -1) {\n            index--\n        }\n\n        return index > 0 ? b[index - 1] : ''\n    }\n\n    patches = inter.reduce((patches, { value, index }) => patches.concat([{\n        type: PatchType.REPOSITION,\n        id: value,\n        after: calAfterForRepostion(index)\n    }]), patches)\n\n    // 新增的元素\n    patches = added.reduce((patches, { value, index }) => patches.concat([{\n        type: PatchType.ADD,\n        id: value,\n        after: index > 0 ? b[index - 1] : ''\n    }]), patches)\n\n    return patches\n}\n",
    "import { Patch, PatchType, Tinker } from './types'\n\nexport const applyPatches = (input: string[], patches: Patch[], tinker: Tinker = new SimpleTinker()) => {\n    let output: string[] = input\n\n    for (let i = 0; i < patches.length; i++) {\n        const patch = patches[i]\n\n        switch (patch.type) {\n        case PatchType.ADD:\n            output = tinker.applyAdditon(output, patch)\n            break\n        case PatchType.DELETE:\n            output = tinker.applyDeletion(output, patch)\n            break\n        case PatchType.REPOSITION:\n            output = tinker.applyRepostion(output, patch)\n        }\n    }\n\n    return output\n}\n\nexport class SimpleTinker implements Tinker {\n    applyDeletion (input: string[], patch: Patch): string[] {\n        if (patch.type !== PatchType.DELETE) return input\n\n        const { id } = patch\n        return input.filter(i => i !== id)\n    }\n\n    applyRepostion (input: string[], patch: Patch): string[] {\n        if (patch.type !== PatchType.REPOSITION) return input\n\n        const { id, after } = patch\n\n        if (after === '') {\n            if (input[0] === id) return input\n            input = input.filter(i => i !== id)\n            return [id, ...input]\n        } else {\n            const index = input.indexOf(id)\n            if (input[index - 1] === after) return input // 该元素前面的元素已经是 after 了\n\n            return input.reduce((output, i) => {\n                if (i !== id) {\n                    output.push(i)\n                    if (i === after) output.push(id)\n                }\n\n                return output\n            }, [])\n        }\n    }\n\n    applyAdditon (input: string[], patch: Patch): string[] {\n        if (patch.type !== PatchType.ADD) return input\n\n        const { id, after } = patch\n        if (after === '') return [id, ...input]\n        const index = input.indexOf(after)\n        return [...input.slice(0, index + 1), id, ...input.slice(index + 1)]\n    }\n}\n",
    "\nreturn _$index_2;\n\n});\n",
    "export { Patch, PatchType, Tinker } from './types'\nexport { listDiff } from './listDiff'\nexport { applyPatches, SimpleTinker } from './applyPatches'\n"
  ],
  "sourceRoot": ""
}